/**
 * Created by lyle on 14-4-13.
 */
var staticVar = require('./staticVar.js');
var spawn = require("child_process").spawn;
var binaryFile = staticVar.getBinaryFile();
var gdb = spawn('gdb',[binaryFile]);

gdb.stdout.setEncoding('utf8');
gdb.stderr.setEncoding('utf8');
gdb.stdin.setEncoding('utf8');


/*命令传到gdb,进行交互*/
exports.interactive = function(socket,commandObject)
{
    gdb.stdin.write(commandObject.com+"\n");

    gdb.stderr.on('data',function(data)
    {
        socket.emit('executeError',{commandResult:data});
        return false;
    });

    gdb.stdout.on('data',function(data)
    {
        socket.emit('executeSuccess',{commandResult:data});
    });
};
